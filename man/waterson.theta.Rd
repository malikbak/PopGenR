% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/essential-pro.R
\name{waterson.theta}
\alias{waterson.theta}
\title{waterson.theta: Calculate Watterson's Theta from Genetic Data}
\usage{
waterson.theta(data, perBP = TRUE)
}
\arguments{
\item{data}{A data frame containing genetic data in VCF format, where the first 9 columns contain metadata and genotype data starts from the 10th column.}

\item{perBP}{A logical value indicating whether to normalize Watterson's Theta by the number of base pairs. If `TRUE`, the result is divided by the total number of base pairs; if `FALSE`, the raw value is returned.}
}
\value{
A numeric value representing Watterson's Theta. If `perBP` is `TRUE`, the result is normalized by the number of base pairs.
}
\description{
This function calculates Watterson's Theta (\(\theta\)), a measure of nucleotide diversity, based on the number of segregating sites in a given dataset. It can be normalized by the number of base pairs.
}
\details{
The function calculates the number of segregating sites (\(S_n\)) in the data that have a minor allele frequency greater than zero. It then uses the formula:

\deqn{\theta = \frac{S_n}{\sum_{i=1}^{2N-1} \frac{1}{i}}}

where \(N\) is the number of individuals in the sample. If `perBP` is set to `TRUE`, the result is normalized by the number of base pairs in the dataset.
}
\note{
The `maf` function must be available in the user's environment for this function to work correctly.
}
\examples{
# Example usage:
vcf_data <- read.vcf("path/to/sample.vcf")
watterson_theta <- waterson.theta(vcf_data, perBP = TRUE)

# Output: A numeric value representing Watterson's Theta normalized by base pairs

}
