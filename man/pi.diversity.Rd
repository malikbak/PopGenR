% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/essential-pro.R
\name{pi.diversity}
\alias{pi.diversity}
\title{pi.diversity: Calculate Nucleotide Diversity (Pi) from VCF Data}
\usage{
pi.diversity(vcf, perBP = TRUE)
}
\arguments{
\item{vcf}{A data frame representing the VCF data, where the first 9 columns contain metadata and the genotype data starts from the 10th column.}

\item{perBP}{A logical value indicating whether to normalize the nucleotide diversity by the number of base pairs. If `TRUE`, the result is divided by the total number of base pairs; if `FALSE`, the raw nucleotide diversity is returned.}
}
\value{
A numeric value representing the nucleotide diversity (Pi). If `perBP` is `TRUE`, the result is normalized by the number of base pairs.
}
\description{
This function calculates the nucleotide diversity (Pi) for a given VCF data frame, which quantifies genetic variation at a particular site or across multiple sites in a population.
}
\details{
The function computes the derived count for each site using the `derivedCount` function. It calculates the total number of alleles (`C`) and uses the formula for nucleotide diversity:

\deqn{\pi = \frac{1}{N(N-1)} \sum_{i=1}^{S} J_i (C - J_i)}

where \( J \) is the derived count, and \( N \) is the total number of alleles. If `perBP` is set to `TRUE`, the function normalizes the result by the total number of base pairs across all chromosomes.
}
\note{
The `derivedCount`, `count.genotypes`, and other necessary functions must be available in the user's environment for this function to work properly.
}
\examples{
# Example usage:
vcf_data <- read.vcf("sample.vcf")
nucleotide_diversity <- pi.diversity(vcf_data, perBP = TRUE)

# Output: A numeric value representing nucleotide diversity normalized by base pairs

}
